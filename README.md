[![Rails Tests and Lint](https://github.com/php8-study/php8-study-app/actions/workflows/ci.yml/badge.svg)](https://github.com/php8-study/php8-study-app/actions/workflows/ci.yml)
[![Deploy](https://github.com/php8-study/php8-study-app/actions/workflows/deploy.yml/badge.svg)](https://github.com/php8-study/php8-study-app/actions/workflows/deploy.yml)
![Ruby](https://img.shields.io/badge/ruby-3.4.7-CC342D.svg?logo=ruby&style=flat)
![Rails](https://img.shields.io/badge/rails-8.1.1-CC0000.svg?logo=rubyonrails&style=flat)
![SQlite](https://img.shields.io/badge/sqlite-3.51-003B57.svg?logo=sqlite&style=flat)
![TailwindCSS](https://img.shields.io/badge/tailwindcss-4.1-38B2AC.svg?logo=tailwind-css&style=flat)
![Hotwire](https://img.shields.io/badge/hotwire-turbo%20%26%20stimulus-yellow.svg?style=flat)
![Kamal](https://img.shields.io/badge/deploy-kamal-blue.svg?style=flat)

# PHP8æŠ€è¡“è€…èªå®šåˆç´šè©¦é¨“ã‚¹ã‚¿ãƒ‡ã‚£
<img width="1594" height="713" alt="image" src="https://github.com/user-attachments/assets/c46767fe-960d-4368-b734-86d2a1b0ebed" />


## æ¦‚è¦
PHP8æŠ€è¡“è€…èªå®šåˆç´šè©¦é¨“ã‚¹ã‚¿ãƒ‡ã‚£ã¯PHP8æŠ€è¡“è€…èªå®šåˆç´šè©¦é¨“ã‚’å—é¨“ã™ã‚‹äººã«å‘ã‘ãŸã€å­¦ç¿’ã‚µãƒãƒ¼ãƒˆã‚¢ãƒ—ãƒªã§ã™ã€‚

## ç‰¹å¾´
PHP8æŠ€è¡“è€…èªå®šåˆç´šè©¦é¨“ã®å…¬å¼èªå®šæ•™æã§ã‚ã‚‹ ç‹¬ç¿’PHP ç¬¬4ç‰ˆ ã®è§£èª¬å†…å®¹ã‚’å‚è€ƒã«200å•ä»¥ä¸Šã®å•é¡Œã‚’å­¦ç¿’ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚

* **ãƒ©ãƒ³ãƒ€ãƒ æ¼”ç¿’**: å…¨å•é¡Œã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«å‡ºé¡Œã•ã‚Œã€æ‰‹è»½ã«å­¦ç¿’ã§ãã¾ã™ã€‚
* **æ¨¡æ“¬è©¦é¨“**: å®Ÿéš›ã®è©¦é¨“ã¨åŒã˜é…åˆ†ãƒ»å•é¡Œæ•°ã§å‡ºé¡Œã•ã‚Œã¾ã™ã€‚
* **æˆç¸¾ç®¡ç†**: æ¨¡æ“¬è©¦é¨“ã®å—é¨“çµæœã‚„å±¥æ­´ã‚’è¨˜éŒ²ãƒ»ç®¡ç†ã§ãã¾ã™ã€‚
* **ç®¡ç†æ©Ÿèƒ½**: ç®¡ç†è€…ã¯å•é¡Œãƒ»ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’ä½œæˆã€å¤‰æ›´ã€å‰Šé™¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

â€» æœ¬ã‚¢ãƒ—ãƒªã¯éå…¬å¼ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## URL
https://php8-study.jp

## ãƒ‡ãƒ¢

### ãƒ©ãƒ³ãƒ€ãƒ å•é¡Œ
https://github.com/user-attachments/assets/1b05f476-4551-42c1-b7f9-85b920c3c249

### æ¨¡æ“¬è©¦é¨“
https://github.com/user-attachments/assets/2051db71-0492-4c33-b9a7-061a5f78372e

### ç®¡ç†è€…ç”»é¢
https://github.com/user-attachments/assets/9986f016-1afd-4219-b778-0e33c8a8ce4a

## ç’°å¢ƒæ§‹ç¯‰
ä»¥ä¸‹ã®æ‰‹é †ã§ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
$ git clone https://github.com/php8-study/php8-study-app.git
$ cd php8_study
$ bin/setup
```

2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š(GitHub OAuth)
æœ¬ç•ªç’°å¢ƒã§ã¯ GitHub OAuth ã‚’ä½¿ç”¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¡Œã„ã¾ã™ã€‚
`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€GitHub Developer Settings ã§å–å¾—ã—ãŸä»¥ä¸‹ã®ã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚
```bash
GITHUB_KEY=your_client_id
GITHUB_SECRET=your_client_secret
```

3.ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•
```bash
$ bin/dev
```

## é–‹ç™ºç’°å¢ƒã§ã®åˆ©ç”¨
**é–‹ç™ºç”¨ãƒ­ã‚°ã‚¤ãƒ³ (èªè¨¼ãƒã‚¤ãƒ‘ã‚¹)**

é–‹ç™ºç’°å¢ƒã«ãŠã„ã¦ã¯ã€GitHubé€£æºã‚’è¡Œã‚ãšã«ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚
1. `bin/dev`ã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã€`http://localhost:3000/`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
2. **ç”»é¢æœ€ä¸‹éƒ¨ã«å›ºå®šè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹é»’ã„ãƒãƒ¼**ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
3. ã€ŒğŸ‘‘ç®¡ç†è€…ã€ã¾ãŸã¯ã€ŒğŸ‘¤ä¸€èˆ¬ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ãã‚Œãã‚Œã®æ¨©é™ã§å³åº§ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ãã¾ã™ã€‚

* å‹•ä½œç¢ºèªã®éš›ã¯ã“ã¡ã‚‰ã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

## Lint & Test
1. Lintã‚’å®Ÿè¡Œã™ã‚‹
```bash
$ bin/lint
```
2. ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹
```bash
$ bundle exec rspec
```

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
* Ruby 3.4.7
* Ruby on Rails 8.1.1
* SQlite 3.51.1

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
* Hotwire (Turbo / Stimulus)
* ViewComponent
* Tailwind CSS

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
* SQlite

##### ãƒ†ã‚¹ãƒˆ
* RSpec
* FactoryBot
* Capybara

## ERå›³
```mermaid
erDiagram
    users ||--o{ exams : "å—é¨“ã™ã‚‹"

    users {
        bigint id PK
        bigint github_id "GitHub ID"
        boolean admin "ç®¡ç†è€…ãƒ•ãƒ©ã‚°"
    }

    exams ||--o{ exam_questions : "å«ã‚€"

    exams {
        bigint id PK
        integer user_id FK
        datetime completed_at "å®Œäº†æ—¥æ™‚"
    }

    categories ||--o{ questions : "åˆ†é¡ã™ã‚‹"

    categories {
        bigint id PK
        integer chapter_number "ç« ç•ªå·"
        string name "ã‚«ãƒ†ã‚´ãƒªå"
        float weight "é‡ã¿ä»˜ã‘"
    }

    questions ||--o{ exam_questions : "å‡ºé¡Œã•ã‚Œã‚‹"
    questions ||--o{ question_choices : "æŒã¤"

    questions {
        bigint id PK
        integer category_id FK
        text content "å•é¡Œæ–‡"
        text explanation "è§£èª¬"
        integer official_page "å…¬å¼ãƒ†ã‚­ã‚¹ãƒˆå‚ç…§P"
        datetime deleted_at "è«–ç†å‰Šé™¤"
    }

    question_choices ||--o{ exam_answers : "é¸æŠã•ã‚Œã‚‹"

    question_choices {
        bigint id PK
        integer question_id FK
        string content "é¸æŠè‚¢å†…å®¹"
        boolean correct "æ­£è§£ãƒ•ãƒ©ã‚°"
    }

    exam_questions ||--o{ exam_answers : "å›ç­”ã‚’æŒã¤"

    exam_questions {
        bigint id PK
        integer exam_id FK
        integer question_id FK
        integer position "å‡ºé¡Œé †"
    }

    exam_answers {
        bigint id PK
        integer exam_question_id FK
        integer question_choice_id FK
    }
```

## ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ
Kamalã‚’ä½¿ç”¨ã—ã€VPSä¸Šã«ã‚³ãƒ³ãƒ†ãƒŠãƒ™ãƒ¼ã‚¹ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã„ã¾ã™ã€‚
Rails 8 ã®æ¨™æº–æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ãŸã€SQLiteãƒ™ãƒ¼ã‚¹ã®ã‚·ãƒ³ã‚°ãƒ«ã‚µãƒ¼ãƒãƒ¼æ§‹æˆã§ã™ã€‚
ä½ä¾¡æ ¼ã§ä¿¡é ¼æ€§ã®ã‚ã‚‹æ§‹æˆã‚’ç›®æŒ‡ã—ã¾ã—ãŸã€‚

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
* **Deployment**: Kamal (Docker on Ubuntu VPS)
* **Web Server**: Puma + Thruster (HTTP/2, Caching)
* **Database**: SQLite3
* **Backup**: Litestream + Cloudflare R2 (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³)
* **Reverse Proxy**: Traefik (SSLè‡ªå‹•åŒ–)

```mermaid
graph TD
    classDef cloud fill:#f9f9f9,stroke:#333,stroke-width:2px;
    classDef storage fill:#e1f5fe,stroke:#0277bd,stroke-width:2px;
    classDef app fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px;

    User((User)) -->|"HTTPS / SSL"| Traefik

    subgraph VPS ["VPS (Ubuntu / Docker)"]
        direction TB
        Traefik["Traefik (Reverse Proxy)"] -->|HTTP| Thruster

        subgraph AppContainer ["Rails 8 Container"]
            direction TB
            Thruster["Thruster (Accelerator)"] -->|Proxy| Puma["Puma (App Server)"]
            Puma -->|"Read/Write"| SQLite[("SQLite3 (Production DB)")]
            
            Litestream["Litestream (Sidecar process)"] -.->|Watch| SQLite
        end
    end

    subgraph Cloud ["Cloud Infrastructure"]
        R2[("Cloudflare R2 (Object Storage)")]:::storage
    end

    Litestream -->|"Real-time Replication (S3 API)"| R2

    Dev((Developer)) -.->|"Git Push"| GitHub["GitHub Actions"]
    GitHub -.->|"Build & Push"| Registry["Docker Registry"]
    Registry -.->|"Kamal Pull"| VPS

    class R2 cloud
    class AppContainer app
```
