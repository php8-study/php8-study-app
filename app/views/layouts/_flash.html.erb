<% flash.each do |key, message| %>
  <%
    if key.to_s == "notice"
      icon_bg     = "bg-emerald-50"
      icon_color  = "text-emerald-600"
      title_text  = "Success"
      icon_name = "check"
      role_attr   = "status"
    else
      icon_bg     = "bg-rose-50"
      icon_color  = "text-rose-600"
      title_text  = "Error"
      icon_name   = "caution"
      role_attr   = "alert"
    end
  %>

  <div role="<%= role_attr %>"
       data-controller="flash"
       class="fixed bottom-5 right-5 z-[100] flex items-start gap-4 p-4
              bg-white border border-slate-100 shadow-[0_4px_20px_-4px_rgba(0,0,0,0.1)] rounded-xl
              transition-all duration-500 ease-out transform translate-y-0 opacity-100
              max-w-md w-full md:w-auto min-w-[320px]">

    <div class="flex-shrink-0 w-10 h-10 rounded-full <%= icon_bg %> flex items-center justify-center">
      <%= inline_svg_tag "icons/#{icon_name}.svg",
        class: "w-5 h-5 #{icon_color}", aria_hidden: true %>
    </div>

    <div class="flex-1 pt-0.5">
      <p class="text-sm font-bold text-slate-800 leading-none mb-1">
        <%= title_text %>
      </p>
      <p class="text-sm text-slate-600 leading-relaxed">
        <%= message %>
      </p>
    </div>

    <button data-action="flash#dismiss" class="text-slate-400 hover:text-slate-600 transition-colors p-1 rounded-md hover:bg-slate-50 cursor-pointer" aria-label="通知を閉じる">
      <%= inline_svg_tag "icons/x.svg", class: "w-4 h-4", aria_hidden: true %>
    </button>
  </div>
<% end %>
