<% title "#{@question.category.name} の演習問題 (No.#{@question.id})" %>
<% summary = strip_tags(@question.content.to_s).squish.truncate(80) %>
<% set_meta_tags description: summary %>

<main class="min-h-screen bg-slate-50 py-12 px-4 sm:px-6">
  <div class="max-w-3xl mx-auto space-y-8">

    <header class="flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="p-2 bg-blue-100 rounded-lg text-blue-600" aria-hidden="true">
          <%= inline_svg_tag "icons/flask.svg", class: "w-6 h-6" %>
        </div>
        <h1 class="text-2xl font-bold text-slate-900 tracking-tight">ランダム出題</h1>
      </div>

      <div class="flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-200 rounded-full shadow-sm text-xs font-bold text-slate-600">
        <%= inline_svg_tag "icons/tag.svg", class: "w-3.5 h-3.5 text-slate-400", aria_hidden: true %>
        <span><%= @question.category.name %></span>
      </div>
    </header>

    <%= render Common::TerminalDisplay::Component.new(
      body: @question.content,
      label: "RandomQuestion.php"
    ) %>

    <% if current_user.present? %>
    <%= render Common::AnswerForm::Component.new(
      question: @question,
      url: question_solution_path(@question),
      method: :get,
      button_text: "解答する",
      input_name: "user_answer_ids[]",
      selected_choice_ids: [],
      guard_answer: false
    ) %>
    <% else %>
      <div class="pt-8 border-t border-slate-200">
        <%= render Common::Choices::Component.new(
          question: @question,
          input_name: nil,
          selected_choice_ids: [],
          disabled: true
        ) %>

        <div class="mt-6">
          <%= render Common::Button::Component.new(
            href: root_path,
            variant: :primary,
            size: :md,
            class: "w-full py-3"
          ) do %>
            ログインして学習をはじめる
          <% end %>
        </div>
      </div>
    <% end %>

  </div>
</main>
